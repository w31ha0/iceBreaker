module.exports=__NEXT_REGISTER_PAGE("/",function(){return{page:webpackJsonp([2],{140:function(e,t){e.exports={FOOD_OPTIONS:["hokkien mee","laksa","mee rebus"],DESHU_OPTIONS:["博A","博B","忍","信","公"]}},284:function(e,t,a){e.exports=a(285)},285:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(38),r=a.n(n),o=a(51),s=a.n(o),i=a(28),l=a.n(i),c=a(0),u=a.n(c),f=a(137),p=a.n(f),d=a(139),b=a.n(d),m=a(134),h=a(54),g=a.n(h),y=a(140),O=a.n(y),v=a(29);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=(t.__proto__||Object.getPrototypeOf(t)).call(this),e=!n||"object"!==E(n)&&"function"!=typeof n?N(a):n,Object.defineProperty(N(e),"handleNameChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({name:t.target.value})}}),Object.defineProperty(N(e),"handleBirthdayChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({birthday:t.target.value})}}),Object.defineProperty(N(e),"handleFavouriteFoodChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target),e.setState({favouriteFood:t.target.value})}}),Object.defineProperty(N(e),"handleDeshuChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target),e.setState({deshu:t.target.value})}}),e.state={name:"",birthday:"",favouriteFood:"",deshu:""},e}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a.Component),a=t,(n=[{key:"render",value:function(){var e=this;return u.a.createElement("div",null,u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Fill in your details below to join the game.")),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Name"),u.a.createElement("input",{onChange:this.handleNameChange,id:"name",class:"form-control",name:"name"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Deshu"),u.a.createElement("select",{onChange:this.handleDeshuChange,className:"form-control",name:"deshu"},u.a.createElement("option",{disabled:!0,selected:!0,value:!0},"Select your deshu."),O.a.DESHU_OPTIONS.map(function(e){return u.a.createElement("option",{value:e},e)}))),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Birthday"),u.a.createElement("input",{type:"date",onChange:this.handleBirthdayChange,class:"form-control",name:"birthday"})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Favourite Food"),u.a.createElement("select",{onChange:this.handleFavouriteFoodChange,class:"form-control",name:"favouriteFood"},u.a.createElement("option",{disabled:!0,selected:!0,value:!0},"Select your favourite food"),O.a.FOOD_OPTIONS.map(function(e){return u.a.createElement("option",{value:e},e)}))),u.a.createElement("button",{onClick:function(){e.props.onSignIn(e.state.name,e.state.birthday,e.state.favouriteFood,e.state.deshu)},type:"submit",className:"btn btn-primary"},"Submit"))}}])&&T(a.prototype,n),r&&T(a,r),t}(),I=a(55),x=a.n(I),S=a(88),C=a(30),j=a.n(C),w=a(138),A=a.n(w);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var U=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),R(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a.Component),a=t,(n=[{key:"render",value:function(){return u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,"Please wait for the game master to start the game."))}}])&&F(a.prototype,n),r&&F(a,r),t}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var q=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=(t.__proto__||Object.getPrototypeOf(t)).call(this,e),a=!r||"object"!==k(r)&&"function"!=typeof r?G(n):r,Object.defineProperty(G(a),"handleLetterSelected",{configurable:!0,enumerable:!0,writable:!0,value:function(e){console.log("Target value is"+e.target.value+".");var t=a.state.lettersUsed,n=a.state.lettersAvailable;t[t.indexOf("-")]=a.state.lettersAvailable[e.target.value],console.log("Letters used are now "+t.join(" ")),n.splice(e.target.value,1),a.setState({lettersUsed:t,lettersAvailable:n}),a.handleLettersChanged()}}),Object.defineProperty(G(a),"removeOneCharFromLettersUsed",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=(n=a.state.lettersUsed).indexOf("-");if(0!=t){var n=a.state.lettersUsed,r=a.state.lettersAvailable,o=0,s=n[o=-1!=t?t-1:n.length-1];n[o]="-",r.push(s),a.setState({lettersUsed:n,lettersAvailable:r}),a.handleLettersChanged()}}}),Object.defineProperty(G(a),"handleLettersChanged",{configurable:!0,enumerable:!0,writable:!0,value:function(){a.state.lettersUsed.join("")===a.props.userName&&"undefined"!=typeof window&&l()({method:"post",url:j.a.API_USER_COMPLETED_GAME}).then(function(e){localStorage.clear(),window.alert("You have completed the game!"),window.location.href="/"}).catch(function(e){console.log(e)})}}),a.state={lettersUsed:[],lettersAvailable:e.lettersAssigned.slice()},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a.Component),a=t,(n=[{key:"componentWillReceiveProps",value:function(e){console.log("Letter component will receive props"),this.setState({lettersUsed:Array.apply(null,{length:e.lettersAssigned.length}).map(function(){return"-"}),lettersAvailable:e.lettersAssigned.slice()})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"jsx-942445572"},u.a.createElement("div",{id:"instructions2",className:"jsx-942445572 form-group"},u.a.createElement("label",{className:"jsx-942445572"},"To complete the game, click on the blue boxes below to form your username: ",this.props.userName)),u.a.createElement("div",{id:"instructions",className:"jsx-942445572 form-group"},u.a.createElement("label",{className:"jsx-942445572"},"To get the letters you need, click a player on the left to begin exchanging letters with him/her.")),u.a.createElement("div",{className:"jsx-942445572"},u.a.createElement("pre",{className:"jsx-942445572"},this.state.lettersUsed.join(" ")),u.a.createElement("button",{id:"cancel-btn",onClick:this.removeOneCharFromLettersUsed,className:"jsx-942445572 btn btn-light"},"Backspace")),u.a.createElement("div",{id:"letters-available",className:"jsx-942445572"},this.state.lettersAvailable.map(function(t,a){return u.a.createElement("button",{id:"letter-available",value:a,onClick:e.handleLetterSelected,className:"jsx-942445572 btn btn-primary"},/\S/.test(t)?t:"Space")})),u.a.createElement(s.a,{styleId:"942445572",css:["#cancel-btn.jsx-942445572{margin-left:0px;margin-bottom:20px;}","#letters-available.jsx-942445572{margin-bottom:20px;}","#letter-available.jsx-942445572{margin:5px;}","#instructions.jsx-942445572{margin-bottom:15px;}","#instructions2.jsx-942445572{margin-bottom:15px;}"]}))}}])&&L(a.prototype,n),r&&L(a,r),t}();function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var V=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=(t.__proto__||Object.getPrototypeOf(t)).call(this),e=!n||"object"!==D(n)&&"function"!=typeof n?M(a):n,Object.defineProperty(M(e),"handleBirthdayChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target.value),e.setState({birthday:t.target.value})}}),Object.defineProperty(M(e),"handleFavouriteFoodChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target.value),e.setState({favouriteFood:t.target.value})}}),Object.defineProperty(M(e),"handleLetterToExchangeChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target.value),e.setState({letterToExchange:t.target.value})}}),Object.defineProperty(M(e),"handleDeshuChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log(t.target.value),e.setState({deshu:t.target.value})}}),Object.defineProperty(M(e),"updateExchangeData",{configurable:!0,enumerable:!0,writable:!0,value:function(t){console.log("Updating exchange data"),e.setState({birthday:t.birthday,favouriteFood:t.favouriteFood,deshu:t.deshu})}}),e.state={birthday:"",favouriteFood:"default",deshu:"default",letterToExchange:""},e}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a.Component),a=t,(n=[{key:"componentWillReceiveProps",value:function(e){console.log("Received new props "+JSON.stringify(e)),console.log("Trying to retrieve from cache"),this.retrieveFromCache(e)}},{key:"componentWillMount",value:function(){console.log("Component will mount"),this.retrieveFromCache(this.props)}},{key:"render",value:function(){return console.log("State is "+JSON.stringify(this.state)),u.a.createElement("div",{className:"jsx-2910031397"},u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},"Name")),u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},this.props.targetUser)),u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},"Deshu"),u.a.createElement("select",{value:this.state.deshu,onChange:this.handleDeshuChange,name:"deshu",className:"jsx-2910031397 form-control"},u.a.createElement("option",{disabled:!0,value:"default",className:"jsx-2910031397"},"Select his/her deshu."),O.a.DESHU_OPTIONS.map(function(e){return u.a.createElement("option",{value:e,className:"jsx-2910031397"},e)}))),u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},"Birthday"),u.a.createElement("input",{type:"date",name:"birthday",value:this.state.birthday,onChange:this.handleBirthdayChange,className:"jsx-2910031397 form-control"})),u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},"Favourite Food"),u.a.createElement("select",{value:this.state.favouriteFood,name:"favouriteFood",onChange:this.handleFavouriteFoodChange,className:"jsx-2910031397 form-control"},u.a.createElement("option",{disabled:!0,value:"default",className:"jsx-2910031397"},"Select his/her favourite food"),O.a.FOOD_OPTIONS.map(function(e){return u.a.createElement("option",{value:e,className:"jsx-2910031397"},e)}))),u.a.createElement("div",{className:"jsx-2910031397 form-group"},u.a.createElement("label",{className:"jsx-2910031397"},"Letter To Exchange Away"),u.a.createElement("select",{name:"letterToExchange",onChange:this.handleLetterToExchangeChange,className:"jsx-2910031397 form-control"},u.a.createElement("option",{disabled:!0,selected:!0,value:!0,className:"jsx-2910031397"},"Select a letter to exchange away"),this.props.lettersAvailable.map(function(e){return u.a.createElement("option",{value:e,className:"jsx-2910031397"},/\S/.test(e)?e:"Space")}))),u.a.createElement("div",{id:"submit-button",className:"jsx-2910031397"},u.a.createElement("button",{onClick:this.submitForm,className:"jsx-2910031397 btn btn-primary"},"Submit")),u.a.createElement(s.a,{styleId:"2910031397",css:["#submit-button.jsx-2910031397{margin-bottom:15px;}"]}))}}])&&B(a.prototype,n),r&&B(a,r),t}();function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?X(e):t}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var J=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return W(n,(a=n=W(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(X(n),"submitForm",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(n.props.userSelected&&n.state.birthday&&n.state.favouriteFood&&n.state.deshu&&n.state.letterToExchange){var t={respond_user:n.props.userSelected,birthday:n.state.birthday,favouriteFood:n.state.favouriteFood,deshu:n.state.deshu,letterToExchange:n.state.letterToExchange,request_user:n.props.userName};console.log("ExchangeRequest: "+JSON.stringify(t)),l()({method:"post",url:j.a.API_SUBMIT_EXCHANGE_REQUEST,data:t}).then(function(e){console.log("Response of ExchangeRequest: "+JSON.stringify(e.data)),1==e.data.success?(n.props.onExchangeRequestSubmitSuccess(n.state.letterToExchange,t),n.props.updateExchangeRequest(t)):v.notify.show(x.a.NOTIFICATION_WRONG_DETAILS,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})}).catch(function(e){console.log(e)})}else v.notify.show(x.a.NOTIFICATION_INCOMPLETE_DETAILS,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})}}),Object.defineProperty(X(n),"retrieveFromCache",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=e.userSelected,a=JSON.parse(localStorage.getItem(t));null!==a?(console.log("Found cached data for "+t+": "+JSON.stringify(a)),n.updateExchangeData(a)):console.log("No cache found for "+t)}}),a))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,V),t}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?z(e):t}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Q=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return K(n,(a=n=K(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(z(n),"submitForm",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(n.state.birthday&&n.state.favouriteFood&&n.state.deshu&&n.state.letterToExchange){var t={request_user:n.props.exchangeRequest.request_user,birthday:n.state.birthday,favouriteFood:n.state.favouriteFood,deshu:n.state.deshu,letterToExchange:n.state.letterToExchange,letterToReceive:n.props.exchangeRequest.letterToExchange,respond_user:n.props.exchangeRequest.respond_user};console.log("ExchangeResponse: "+JSON.stringify(t)),l()({method:"post",url:j.a.API_SUBMIT_EXCHANGE_RESPONSE,data:t}).then(function(e){console.log("Response of ExchangeResponse: "+JSON.stringify(e.data)),1==e.data.success?n.props.onExchangeResponseSubmitSuccess(t):v.notify.show(x.a.NOTIFICATION_WRONG_DETAILS,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})}).catch(function(e){console.log(e)})}else v.notify.show(x.a.NOTIFICATION_INCOMPLETE_DETAILS,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})}}),Object.defineProperty(z(n),"retrieveFromCache",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=e.exchangeRequest.request_user,a=JSON.parse(localStorage.getItem(t));null!==a?(console.log("Found cached data for "+t+": "+JSON.stringify(a)),n.updateExchangeData(a)):console.log("No cache found for "+t)}}),a))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,V),t}();function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ee(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a.Component),a=t,(n=[{key:"render",value:function(){return u.a.createElement("div",{style:{textAlign:"center",marginBottom:"30px"}},u.a.createElement("h1",{style:{marginBottom:"20px"}},"You have entered the correct details! Waiting for other party to verify"),u.a.createElement("button",{onClick:this.props.cancel,className:"btn btn-danger"},"Cancel"))}}])&&$(a.prototype,n),r&&$(a,r),t}();function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}a.d(t,"default",function(){return oe});var oe=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=(t.__proto__||Object.getPrototypeOf(t)).call(this),e=!n||"object"!==ae(n)&&"function"!=typeof n?re(a):n,Object.defineProperty(re(e),"setupPusher",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.pusher=new p.a(A.a.PUSHER_APP_KEY,{cluster:A.a.PUSHER_APP_CLUSTER,encrypted:!0}),e.channel=e.pusher.subscribe(x.a.PUSHER_CHANNEL),e.channel.bind(x.a.PUSHER_USER_LIST_UPDATE_EVENT,function(t){console.log("Received new user list from Pusher: "+t);var a=t.map(function(e){return e.name});e.setState({activeUsers:a})}),e.channel.bind(x.a.PUSHER_NEW_EXCHANGE_REQUEST_EVENT,function(t){console.log("Received new exchange request: "+JSON.stringify(t)),t.respond_user==e.state.userName&&(console.log("Exchange request is for me."),e.exchangeRequest=t,e.setState({isVerifyingForCounterParty:!0}))}),e.channel.bind(x.a.EXCHANGE_COMPLETED_EVENT,function(t){t.request_user==e.state.userName&&(v.notify.show(x.a.NOTIFICATION_EXCHANGE_SUCCESSFUL,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR}),console.log("Exchange request has completed: "+JSON.stringify(t)),console.log("Letters assigned are now "+e.state.lettersAssigned),e.setState({isWaitingForCounterPartyToVerify:!1}),e.retrieveAllGameInformation())}),e.channel.bind(x.a.PUSHER_GAME_START_EVENT,function(){e.state.signedIn&&(console.log("Game has started...loading main page..."),e.setState({isWaitingForGameToStart:!1}),e.retrieveAllGameInformation(),v.notify.show(x.a.NOTIFICATION_GAME_BEGUN,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR}))}),e.channel.bind(x.a.PUSHER_GAME_STOP_EVENT,function(){e.state.signedIn&&(localStorage.clear(),window.alert("Game has been forcefully stopped by game master"),window.location.href="/")}),e.channel.bind(x.a.PUSHER_EXCHANGE_CANCELLED_EVENT,function(t){console.log("Received cancel request: "+JSON.stringify(t)),t.request_user==e.state.userName&&e.state.isWaitingForCounterPartyToVerify?(e.setState({isWaitingForCounterPartyToVerify:!1}),v.notify.show(x.a.NOTIFICATION_CANCEL_EXCHANGE,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})):t.respond_user==e.state.userName&&e.state.isVerifyingForCounterParty&&(e.setState({isVerifyingForCounterParty:!1}),v.notify.show(x.a.NOTIFICATION_CANCEL_EXCHANGE,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR}))})}}),Object.defineProperty(re(e),"checkGameState",{configurable:!0,enumerable:!0,writable:!0,value:function(){b.a.checkAuthenticated().then(function(t){e.setState({signedIn:!0,authenticationChecked:!0})},function(t){e.setState({authenticationChecked:!0})}),b.a.checkGameStarted().then(function(t){e.setState({isWaitingForGameToStart:!1}),e.retrieveAllGameInformation(),e.setState({gameStartedChecked:!0})},function(t){e.setState({gameStartedChecked:!0})})}}),Object.defineProperty(re(e),"retrieveAllGameInformation",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.retriveUserName(),e.retriveLetters(),e.retrieveActiveUsers()}}),Object.defineProperty(re(e),"cancelWaitingForVerification",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({isWaitingForCounterPartyToVerify:!1}),b.a.cancelExchange(e.exchangeRequest)}}),Object.defineProperty(re(e),"onExchangeRequestSubmitSuccess",{configurable:!0,enumerable:!0,writable:!0,value:function(t,a){"undefined"!=typeof localStorage&&(console.log("Setting local storage "+a.respond_user+":"+a),localStorage.setItem(a.respond_user,JSON.stringify(a)));var n=e.state.userSelected;e.setState({isWaitingForCounterPartyToVerify:!0,letterToGive:t,userSelected:""}),e.setState({userSelected:n})}}),Object.defineProperty(re(e),"onExchangeResponseSubmitSuccess",{configurable:!0,enumerable:!0,writable:!0,value:function(t){v.notify.show(x.a.NOTIFICATION_EXCHANGE_SUCCESSFUL,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR}),e.retriveLetters(),"undefined"!=typeof localStorage&&(console.log("Setting local storage "+t.request_user+":"+t),localStorage.setItem(t.request_user,JSON.stringify(t))),e.setState({isVerifyingForCounterParty:!1})}}),Object.defineProperty(re(e),"onUserSelected",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.state.activeUsers[t.target.id]===e.state.userName?v.notify.show(x.a.NOTIFICATION_SAME_NAME_SELECTED,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR}):(console.log("Setting user selected to "+t.target.id),e.setState({userSelected:e.state.activeUsers[t.target.id]}))}}),Object.defineProperty(re(e),"retriveLetters",{configurable:!0,enumerable:!0,writable:!0,value:function(){l()({method:"post",url:j.a.API_GET_ASSIGNED_LETTERS}).then(function(t){console.log("Got letters assigned as "+t.data),e.setState({lettersAssigned:t.data})}).catch(function(e){console.log(e)})}}),Object.defineProperty(re(e),"retrieveActiveUsers",{configurable:!0,enumerable:!0,writable:!0,value:function(){l()({method:"post",url:j.a.API_GET_ALL_ACTIVE_USERS}).then(function(t){var a=t.data.map(function(e){return e.user.name});console.log("Parsed active users as "+a),e.setState({activeUsers:a})}).catch(function(e){console.log(e)})}}),Object.defineProperty(re(e),"retriveUserName",{configurable:!0,enumerable:!0,writable:!0,value:function(){l()({method:"post",url:j.a.API_GET_SESSION}).then(function(t){void 0!==t.data.user&&(console.log("Received username as  "+t.data.user.name),e.setState({userName:t.data.user.name}))}).catch(function(e){console.log(e)})}}),Object.defineProperty(re(e),"cancelRespondToRequester",{configurable:!0,enumerable:!0,writable:!0,value:function(){e.setState({isVerifyingForCounterParty:!1}),b.a.cancelExchange(e.exchangeRequest)}}),Object.defineProperty(re(e),"onSignIn",{configurable:!0,enumerable:!0,writable:!0,value:function(t,a,n,r){t=t.toUpperCase(),console.log("Signing in..."+t),l()({method:"post",url:j.a.API_LOGIN_USER,data:{name:t,birthday:a,favouriteFood:n,deshu:r}}).then(function(t){1==t.data.result?e.setState({signedIn:!0}):v.notify.show(t.data.message,g.a.NOTIFICATION_TYPE,g.a.NOTIFICATION_TIMEOUT,{background:g.a.NOTIFICATION_BACKGROUND_COLOR,text:g.a.NOTIFICATION_TEXT_COLOR})}).catch(function(e){console.log(e)})}}),Object.defineProperty(re(e),"updateExchangeRequest",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.exchangeRequest=t}}),e.state={userName:"",activeUsers:["LEW WEI HAO","TAN YI KAN"],lettersAssigned:["A","B","C"," "],userSelected:"",isWaitingForCounterPartyToVerify:!1,isVerifyingForCounterParty:!1,isWaitingForGameToStart:!0,signedIn:!1,letterToGive:"",authenticationChecked:!1,gameStartedChecked:!1},e.exchangeRequest={},e}var a,n,o,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,m["a"]),a=t,(n=[{key:"componentDidMount",value:(i=r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setupPusher(),this.checkGameState();case 2:case"end":return e.stop()}},e,this)}),c=function(){var e=this,t=arguments;return new Promise(function(a,n){var r=i.apply(e,t);function o(e,t){try{var o=r[e](t),i=o.value}catch(e){return void n(e)}o.done?a(i):Promise.resolve(i).then(s,l)}function s(e){o("next",e)}function l(e){o("throw",e)}s()})},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this;return this.state.authenticationChecked&&this.state.gameStartedChecked?this.state.signedIn?this.state.isWaitingForGameToStart&&this.state.signedIn?u.a.createElement(S.a,null,u.a.createElement(U,null)):this.state.isWaitingForCounterPartyToVerify?u.a.createElement(S.a,null,u.a.createElement(te,{cancel:this.cancelWaitingForVerification})):this.state.isVerifyingForCounterParty?u.a.createElement(S.a,null,u.a.createElement("div",{className:"form-group"},u.a.createElement("label",null,this.exchangeRequest.request_user," has requested to connect.Please fill in his details below.")),u.a.createElement(Q,{targetUser:this.exchangeRequest.request_user,userName:this.exchangeRequest.request_user,onExchangeResponseSubmitSuccess:this.onExchangeResponseSubmitSuccess,lettersAvailable:this.state.lettersAssigned,exchangeRequest:this.exchangeRequest}),u.a.createElement("div",{id:"cancel-button"},u.a.createElement("button",{onClick:this.cancelRespondToRequester,className:"btn btn-danger"},"Cancel"))):u.a.createElement(S.a,null,u.a.createElement("div",{id:"wrapper",className:"jsx-2479897932"},u.a.createElement("div",{id:"sidebar-wrapper",className:"jsx-2479897932"},u.a.createElement("nav",{id:"spy",className:"jsx-2479897932"},u.a.createElement("ul",{className:"jsx-2479897932 sidebar-nav nav"},this.state.activeUsers.map(function(t,a){return u.a.createElement("li",{id:a,onClick:e.onUserSelected,className:"jsx-2479897932 sidebar-brand"},t)})))),u.a.createElement("div",{id:"page-content-wrapper",className:"jsx-2479897932"},u.a.createElement("div",{"data-spy":"scroll","data-target":"#spy",className:"jsx-2479897932 page-content inset"},u.a.createElement(q,{userName:this.state.userName,lettersAssigned:this.state.lettersAssigned}),u.a.createElement("div",{style:{marginTop:"50px",marginBottom:"50px"},className:"jsx-2479897932 form-group"},u.a.createElement("label",{className:"jsx-2479897932"},"Fill in the details of the player you would like to exchange with below.")),u.a.createElement(J,{targetUser:this.state.userSelected,userName:this.state.userName,onExchangeRequestSubmitSuccess:this.onExchangeRequestSubmitSuccess,userSelected:this.state.userSelected,lettersAvailable:this.state.lettersAssigned,updateExchangeRequest:this.updateExchangeRequest})))),u.a.createElement(s.a,{styleId:"2479897932",css:["#wrapper.active.jsx-2479897932{padding-left:0;}","#wrapper.active.jsx-2479897932 #sidebar-wrapper.jsx-2479897932{left:0;}","#page-content-wrapper.jsx-2479897932{width:100%;}",".sidebar-nav.jsx-2479897932 li.jsx-2479897932{line-height:40px;text-indent:20px;}",".sidebar-nav.jsx-2479897932 li.jsx-2479897932 a.jsx-2479897932{color:#999999;display:block;-webkit-text-decoration:none;text-decoration:none;padding-left:60px;}",".sidebar-nav.jsx-2479897932 li.jsx-2479897932 a.jsx-2479897932 span.jsx-2479897932:before{position:absolute;left:0;color:#41484c;text-align:center;width:20px;line-height:18px;}",".sidebar-nav.jsx-2479897932 li.jsx-2479897932 a.jsx-2479897932:hover,.sidebar-nav.jsx-2479897932 li.active.jsx-2479897932{color:#fff;background:rgba(255,255,255,0.2);-webkit-text-decoration:none;text-decoration:none;}",".sidebar-nav.jsx-2479897932 li.jsx-2479897932 a.jsx-2479897932:active,.sidebar-nav.jsx-2479897932 li.jsx-2479897932 a.jsx-2479897932:focus{-webkit-text-decoration:none;text-decoration:none;}",".sidebar-nav.jsx-2479897932>.sidebar-brand.jsx-2479897932 a.jsx-2479897932{color:#999999;}",".sidebar-nav.jsx-2479897932>.sidebar-brand.jsx-2479897932 a.jsx-2479897932:hover{color:#fff;background:none;}",".inset.jsx-2479897932{padding:20px;}","@media (min-width:1224px){#wrapper.jsx-2479897932{padding-left:250px;-webkit-transition:all 0.4s ease 0s;transition:all 0.4s ease 0s;}#sidebar-wrapper.jsx-2479897932{margin-left:-250px;left:250px;width:250px;background:#000;position:fixed;height:100%;overflow-y:auto;z-index:1000;-webkit-transition:all 0.4s ease 0s;transition:all 0.4s ease 0s;color:white;}.sidebar-nav.jsx-2479897932>.sidebar-brand.jsx-2479897932{height:65px;line-height:60px;font-size:18px;}.sidebar-nav.jsx-2479897932{position:absolute;top:0;width:250px;list-style:none;margin:0;padding:0;}}","@media (max-width:1224px){#wrapper.jsx-2479897932{padding-left:100px;-webkit-transition:all 0.4s ease 0s;transition:all 0.4s ease 0s;}#sidebar-wrapper.jsx-2479897932{margin-left:-100px;left:100px;width:100px;background:#000;position:fixed;height:100%;overflow-y:auto;z-index:1000;-webkit-transition:all 0.4s ease 0s;transition:all 0.4s ease 0s;color:white;}.sidebar-nav.jsx-2479897932>.sidebar-brand.jsx-2479897932{height:65px;line-height:60px;font-size:10px;}.sidebar-nav.jsx-2479897932{position:absolute;top:0;width:100px;list-style:none;margin:0;padding:0;}}"]})):u.a.createElement(S.a,null,u.a.createElement(_,{onSignIn:this.onSignIn})):u.a.createElement(S.a,null)}}])&&ne(a.prototype,n),o&&ne(a,o),t}()}},[284]).default}});